<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Siddhivinayak Platinum</title>

    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700,900" rel="stylesheet">

    <link rel="stylesheet" href="css/bootstrap.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/owl.carousel.min.css">
    <link rel="stylesheet" href="css/owl.theme.default.min.css">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="responsive.css">
    <link rel="shortcut icon" href="img/logo1.jpg" type="image/x-icon">
</head>

<body>
    <div class="wrapper">
        <header class="header">
            <section class="header-top">
                <div class="container">
                    <div class="row">
                        <div class="col-md-8 col-sm-8 col-xs-12">
                            <div class="contact">
                                <p><span class="phone"><a href="#"></a></span><span class="email"><a href="#">Email: siddhivinayakplatinum@gmail.com</a></span></p>
                            </div>
                        </div>
                       
                    </div>
                </div>
            </section>
            <section class="header-bottom borderstyle">
                <div class="container">
                    <div class="row">
                        <div class="col-md-5 col-sm-12 col-xs-12">
                            <a href="#">
                                <div class="main-logo">
                                    <!--<img src="img/logo.png" alt="">-->
                                    <h2>Siddhivinayak Platinum</h2>
                                </div>
                            </a>
                        </div>
                        <div class="col-md-7 col-sm-12 col-xs-12">
                            <div class="menu">
                                <ul class="nav navbar-nav">
                                    <li><a href="index.html">HOME </a></li>
                                    <li class="activeHeader"><a href="ViewDoc.html">Documents</a></li>
                                    <li><a href="ContactForm.html">Feedback\Suggestions</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </header>
        
	
       <div class="container">
            <form id="contact" action="" method="post">
                <h3 style="color:darkgreen"> View Flats and Shops Documents  <div class="loader" style="display:none;"></div></h3>
				
            </form>
			
			<div class="row">
				<div class="form-group name1 col-md-6">
					<label for="exampleInputEmail1" class="formText">Select Yout Flat No:</label>
					<select name="flatDetails" id="flatDetails" class="form-control"></select>
				</div>
				<div class="form-group name1 col-md-6">					
					<input type="button" style="margin-top:25px" value="Verify Mobile No." class="btn btn-primary" onclick="return displayPopUp(this)">
				</div>
			</div>   
			<div class="row" >
					<div class="form-group name1 col-md-6" id="docPlace">
						
					</div>
				
			</div> 

		</div>
        <div class="clear"></div>
		<br><br><br><br>
        <footer class="footer">
            <div class="container">
                <div class="row">
                    <div class="col-md-5 col-sm-8">
                        <div class="footer-text one">
                            <h3>CONTACT US</h3>
                            <ul>
                                <li><a href="#"><i class="material-icons">location_on</i>Sector 23, Plot Number 142, ULWE, Navi Mumbai</a></li>
                                <li><a href="#"><i class="material-icons">email</i>siddhivinayakplatinum@gmail.com</a></li>
                                <!--<li><a href="#"><i class="material-icons">call </i>9820684534</a></li>-->
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="footer_bottom">
                <p>Copyright@2020 <a href="#">Jalaj Rajpurohit</a> All Rights Reserved</p>
            </div>
        </footer>
    </div>
	
	<div class="modal fade" id="optModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">OTP Verification</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <h4 id="confirmBody">Enter OTP send to Mobile No. <span id="dymobileNo"></span></h4>
		<div class="row">
				<div class="form-group name1 col-md-6">
					<input type="number" class="form-control" id="otp" name="otp"  maxlength="6" autocomplete="off">
				</div>
				
			</div> 
      </div>
	  <div class="modal-footer" id="footerSection">			
			<input type="button" value="Verify OTP" class="btn btn-primary" onclick="return verfiyOTP(this)">
			<button type="button" onClick="return closePopUp()" class="btn">Close</button>
	  </div>
    </div>
  </div>
  </div>
    <script src="js/jquery-3.1.1.min.js"></script>
    <script src="js/animationCounter.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/active.js"></script>
   
   
    <script>getFlatDetails();
	function getFlatDetails(){
		$(".loader").show();
		$("#flatDetails").append($("<option></option>").attr("value", "-1").text("--Select--")); 
		 $.ajax({
			  type: 'POST',
			  url: "https://5vvnjl5hii.execute-api.ap-south-1.amazonaws.com/dev/SP/fetchSPDetails",
			  success: function (response1) { 	  			
					$.each(response1, function(key,response) {	
								$("#flatDetails").append($("<option></option>").attr("flatno", $(response).attr("id")).attr("value", $(response).attr("mobileNo")).text($(response).attr("id") + " - " +$(response).attr("ownerName"))); 
						});
						
						$(".loader").hide();
					},
			  error : function (response1) { 
						alert(response1)
					}
			});
		}
	function displayPopUp(obj){
		if($("#flatDetails").val() == -1){
			alert("Please Select Flat No.");
			return false;
		}
		$(".loader").show();
		var jsonStr = '{"flatno":"'+$("#flatDetails :selected").attr('flatno')+'"}';
		$.ajax({
			  type: 'POST',
			  data:jsonStr,
			  url: "https://5vvnjl5hii.execute-api.ap-south-1.amazonaws.com/dev/SP/generateOTP",
			  success: function (response1) { 	  			
						$("#optModal").modal('show');
						$("#dymobileNo").html($("#flatDetails").val());
						$(".loader").hide();
					},
			  error : function (response1) { 
						alert(response1)
					}
			});
		

	}	
	function closePopUp(){
	$("#optModal").modal('hide');
	}
	function verfiyOTP(obj){
	if($("#otp").val() == "" || $("#otp").val().length !=4){
			alert("Please Enter valid OTP.");
			return false;
		}
		$(obj).attr('disabled',true);
		$(obj).val('Please Wait ....');
	
		var jsonStr = '{"otp":"'+$("#otp").val()+'","flatno":"'+$("#flatDetails :selected").attr('flatno')+'"}';
		$.ajax({
			  type: 'POST',
			  data:jsonStr,
			  url: "https://5vvnjl5hii.execute-api.ap-south-1.amazonaws.com/dev/SP/verifyOTP",
			  success: function (response1) { 
						if(response1.startsWith("Invalid")){
							alert(response1);
						}else{			  
							$("#optModal").modal('hide');
							var str = '<h1>Below are your Document</h1><ol>';
								$.each(response1.split(","), function() {	
										console.log(this)
										str = str + '<li><a target="_blank" href="Document/'+$("#flatDetails :selected").attr('flatno')+'/'+this+ '">'+this+'</a></li>';
								});
								str = str + "</ol>";								
							$("#docPlace").append(str);
						}
						$(obj).attr('disabled',false);
						$(obj).val('Verify OTP');
					},
			  error : function (response1) { 
						alert(response1)
					}
			});
	}
	</script>


</body>

</html>